@page "/register"

@using CateringApi.Helpers.Common.DTOs;
@using CateringApi.Helpers.Common.Requests;
@using Catering_WebAssembly.Services;

@inject NavigationManager NavManager
@inject IAuthService AuthService

<h2 class="text-center">Create a new account.</h2>
<hr />
<div class="col-md-10 mx-auto">
	<EditForm Model="newUser" OnValidSubmit="@HandleValidRequest" OnInvalidSubmit="@HandleFailedRequest">
		<div class="row">
			<div class="col-md-6">
				<div class="form-floating">
					<InputText class="form-control" @bind-Value="@newUser.FirstName"></InputText>
					<label>First Name</label>
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-floating">
					<InputText class="form-control" @bind-Value="@newUser.LastName"></InputText>
					<label>Last Name</label>
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-floating">
					<InputText class="form-control" @bind-Value="@newUser.Email"></InputText>
					<label>Email</label>
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-floating">
					<InputDate class="form-control" @bind-Value="@newUser.Birthday"></InputDate>
					<label>Birthday</label>
				</div>
			</div>
			<div class="col-md-6">
				<div class="form-floating">
					<InputText class="form-control" @bind-Value="newUser.Password"></InputText>
					<label>Password</label>
				</div>
			</div>
			@*<div class="col-md-6">
				<div class="form-floating">
					<input asp-for="Input.ConfirmPassword" class="form-control" autocomplete="new-password" aria-required="true" />
					<label asp-for="Input.ConfirmPassword"></label>
					<span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
				</div>
			</div>*@
			<div class="row">
				<div class="col-md-4 mx-auto">
					<button id="registerSubmit" type="submit" class="w-100 btn btn-lg btn-primary">Register</button>
					<p>
						Already have an account? <a @onclick="@GoToLogin">Sign in</a>
					</p>
				</div>
			</div>
		</div>
	</EditForm>
</div>
@*@section Styles{
	<style>
		body {
			background-color: lightyellow;
			font-weight: 600;
		}

		.col-md-6 {
			margin-bottom: 20px;
		}

		.row {
			margin-top: 20px;
		}

		#registerSubmit{
			margin-bottom: 20px;
		}

	</style>
	}
@section Scripts {
	<partial name="_ValidationScriptsPartial" />
}
*@

@code {

	protected UserRegistrationRequest newUser = new();

	protected void GoToLogin()
	{
		NavManager.NavigateTo("/Login");
	}

	protected async Task HandleValidRequest()
	{
		var result = await AuthService.Register(newUser);

		/////ToDo
	}

	protected async Task HandleFailedRequest()
	{

	}
}
